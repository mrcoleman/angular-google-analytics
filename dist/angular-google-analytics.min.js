/**
 * Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v1.1.7 - 2016-12-20
 * @link http://github.com/revolunet/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com> (https://github.com/revolunet)
 * @contributors Julien Bouquillon (https://github.com/revolunet),Justin Saunders (https://github.com/justinsa),Chris Esplin (https://github.com/deltaepsilon),Adam Misiorny (https://github.com/adam187)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a,b){"use strict";"undefined"!=typeof module&&module.exports?(b("undefined"==typeof angular?require("angular"):angular),module.exports="angular-google-analytics"):"function"==typeof define&&define.amd?define(["angular"],b):b(a.angular)}(this,function(a,b){"use strict";return a.module("angular-google-analytics",[]).provider("Analytics",function(){var c,d,e,f,g,h,i=!0,j="auto",k=!1,l=!1,m="USD",n=!1,o=!1,p=!1,q=!1,r=!1,s=!1,t=!1,u=!1,v=!1,w=!1,x=!1,y="$routeChangeSuccess",z=!1,A=!1,B=!1,C="",D=!0,E=!1;this.log=[],this.offlineQueue=[],this.setAccount=function(d){return c=a.isUndefined(d)||d===!1?b:a.isArray(d)?d:a.isObject(d)?[d]:[{tracker:d,trackEvent:!0}],this},this.trackPages=function(a){return D=!!a,this},this.trackPrefix=function(a){return C=a,this},this.setDomainName=function(a){return e=a,this},this.useDisplayFeatures=function(a){return p=!!a,this},this.useAnalytics=function(a){return i=!!a,this},this.useEnhancedLinkAttribution=function(a){return t=!!a,this},this.useCrossDomainLinker=function(a){return l=!!a,this},this.setCrossLinkDomains=function(a){return d=a,this},this.setPageEvent=function(a){return y=a,this},this.setCookieConfig=function(a){return j=a,this},this.useECommerce=function(a,b){return r=!!a,s=!!b,this},this.setCurrency=function(a){return m=a,this},this.setRemoveRegExp=function(a){return a instanceof RegExp&&(g=a),this},this.setExperimentId=function(a){return f=a,this},this.ignoreFirstPageLoad=function(a){return u=!!a,this},this.trackUrlParams=function(a){return E=!!a,this},this.disableAnalytics=function(a){return q=!!a,this},this.setHybridMobileSupport=function(a){return w=!!a,this},this.setSiteSpeedSampleRate=function(a){return h=!!a,this},this.startOffline=function(a){return x=!!a,x===!0&&this.delayScriptTag(!0),this},this.delayScriptTag=function(a){return o=!!a,this},this.logAllCalls=function(a){return v=!!a,this},this.enterTestMode=function(){return A=!0,this},this.enterDebugMode=function(a){return n=!0,B=!!a,this},this.readFromRoute=function(a){return z=!!a,this},this.$get=["$document","$location","$log","$rootScope","$window","$injector",function(F,G,H,I,J,K){var L=this,M=function(b,c){return a.isObject(c)&&a.isDefined(c[b])},N=function(a,b,c){return M(a,b)&&b[a]===c},O=function(b,c){return a.isString(c)?c+"."+b:M("name",c)?c.name+"."+b:b},P={};z&&(K.has("$route")?P=K.get("$route"):H.warn("$route service is not available. Make sure you have included ng-route in your application dependencies."));var Q=function(){if(z&&P.current&&"pageTrack"in P.current)return P.current.pageTrack;var a=E?G.url():G.path();return g?a.replace(g,""):a},R=function(){var b={utm_source:"campaignSource",utm_medium:"campaignMedium",utm_term:"campaignTerm",utm_content:"campaignContent",utm_campaign:"campaignName"},c={};return a.forEach(G.search(),function(d,e){var f=b[e];a.isDefined(f)&&(c[f]=d)}),c},S=function(a,b,c,d,e,f,g,h,i){var j={};return a&&(j.id=a),b&&(j.affiliation=b),c&&(j.revenue=c),d&&(j.tax=d),e&&(j.shipping=e),f&&(j.coupon=f),g&&(j.list=g),h&&(j.step=h),i&&(j.option=i),j},T=function(b,c){var d="",e="https:"===document.location.protocol,f="chrome-extension:"===document.location.protocol,g=i===!0&&w===!0;return b=a.isString(b)?b:"",c=a.isString(c)?c:"",""!==b&&(d="http:"+b),(f||g||e&&""!==c)&&(d="https:"+c),d},U=function(a){!i&&J._gaq&&"function"==typeof a&&a()},V=function(){var a=Array.prototype.slice.call(arguments);return x===!0?void L.offlineQueue.push([V,a]):(J._gaq||(J._gaq=[]),v===!0&&L._log.apply(L,a),void J._gaq.push(a))},W=function(a){i&&J.ga&&"function"==typeof a&&a()},X=function(){var a=Array.prototype.slice.call(arguments);return x===!0?void L.offlineQueue.push([X,a]):"function"!=typeof J.ga?void L._log("warn","ga function not set on window"):(v===!0&&L._log.apply(L,a),void J.ga.apply(null,a))},Y=function(a){var b=Array.prototype.slice.call(arguments,1),d=b[0],e=[];return"function"==typeof a?c.forEach(function(b){a(b)&&e.push(b)}):e=c,0===e.length?void X.apply(L,b):void e.forEach(function(a){M("select",a)&&"function"==typeof a.select&&!a.select(b)||(b[0]=O(d,a),X.apply(L,b))})};return this._log=function(){var a=Array.prototype.slice.call(arguments);if(a.length>0){if(a.length>1)switch(a[0]){case"debug":case"error":case"info":case"log":case"warn":H[a[0]](a.slice(1))}L.log.push(a)}},this._createScriptTag=function(){L._registerScriptTags(),L._registerTrackers()},this._createAnalyticsScriptTag=function(){L._registerScriptTags(),L._registerTrackers()},this._registerScriptTags=function(){var a,b=F[0],d=T();if(k===!0)return void L._log("warn","Script tags already created");if(q===!0&&c.forEach(function(a){L._log("info","Analytics disabled: "+a.tracker),J["ga-disable-"+a.tracker]=!0}),i===!0){if(a=d+"//www.google-analytics.com/"+(n?"analytics_debug.js":"analytics.js"),A!==!0?!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,b,"script",a,"ga"):("function"!=typeof J.ga&&(J.ga=function(){}),L._log("inject",a)),B&&(J.ga_debug={trace:!0}),f){var e=b.createElement("script"),g=b.getElementsByTagName("script")[0];e.src=d+"//www.google-analytics.com/cx/api.js?experiment="+f,g.parentNode.insertBefore(e,g)}}else a=T("//www","//ssl")+".google-analytics.com/ga.js",p===!0&&(a=d+"//stats.g.doubleclick.net/dc.js"),A!==!0?!function(){var c=b.createElement("script");c.type="text/javascript",c.async=!0,c.src=a;var d=b.getElementsByTagName("script")[0];d.parentNode.insertBefore(c,d)}():L._log("inject",a);return k=!0,!0},this._registerTrackers=function(){return!c||c.length<1?void L._log("warn","No accounts to register"):(i===!0?c.forEach(function(b){b.crossDomainLinker=M("crossDomainLinker",b)?b.crossDomainLinker:l,b.crossLinkDomains=M("crossLinkDomains",b)?b.crossLinkDomains:d,b.displayFeatures=M("displayFeatures",b)?b.displayFeatures:p,b.enhancedLinkAttribution=M("enhancedLinkAttribution",b)?b.enhancedLinkAttribution:t,b.set=M("set",b)?b.set:{},b.trackEcommerce=M("trackEcommerce",b)?b.trackEcommerce:r,b.trackEvent=!!M("trackEvent",b)&&b.trackEvent;var c={};M("fields",b)?c=b.fields:M("cookieConfig",b)?a.isString(b.cookieConfig)?c.cookieDomain=b.cookieConfig:c=b.cookieConfig:a.isString(j)?c.cookieDomain=j:j&&(c=j),b.crossDomainLinker===!0&&(c.allowLinker=!0),h&&(c.siteSpeedSampleRate=h),M("name",b)&&(c.name=b.name),b.fields=c,X("create",b.tracker,b.fields),w===!0&&X(O("set",b),"checkProtocolTask",null);for(var e in b.set)b.set.hasOwnProperty(e)&&X(O("set",b),e,b.set[e]);b.crossDomainLinker===!0&&(X(O("require",b),"linker"),a.isDefined(b.crossLinkDomains)&&X(O("linker:autoLink",b),b.crossLinkDomains)),b.displayFeatures&&X(O("require",b),"displayfeatures"),b.trackEcommerce&&(s?(X(O("require",b),"ec"),X(O("set",b),"&cu",m)):X(O("require",b),"ecommerce")),b.enhancedLinkAttribution&&X(O("require",b),"linkid"),D&&!u&&X(O("send",b),"pageview",C+Q())}):(c.length>1&&(L._log("warn","Multiple trackers are not supported with ga.js. Using first tracker only"),c=c.slice(0,1)),V("_setAccount",c[0].tracker),e&&V("_setDomainName",e),t&&V("_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"),D&&!u&&(g?V("_trackPageview",Q()):V("_trackPageview"))),!0)},this._ecommerceEnabled=function(a,b){var c=r&&!s;return a===!0&&c===!1&&(r&&s?L._log("warn",b+" is not available when Enhanced Ecommerce is enabled with analytics.js"):L._log("warn","Ecommerce must be enabled to use "+b+" with analytics.js")),c},this._enhancedEcommerceEnabled=function(a,b){var c=r&&s;return a===!0&&c===!1&&L._log("warn","Enhanced Ecommerce must be enabled to use "+b+" with analytics.js"),c},this._trackPage=function(c,d,e){c=c?c:Q(),d=d?d:F[0].title,U(function(){V("_set","title",d),V("_trackPageview",C+c)}),W(function(){var f={page:C+c,title:d};a.extend(f,R()),a.isObject(e)&&a.extend(f,e),Y(b,"send","pageview",f)})},this._trackEvent=function(b,c,d,e,f,g){U(function(){V("_trackEvent",b,c,d,e,!!f)}),W(function(){var h={},i=function(a){return N("trackEvent",a,!0)};a.isDefined(f)&&(h.nonInteraction=!!f),a.isObject(g)&&a.extend(h,g),a.isDefined(h.page)||(h.page=Q()),Y(i,"send","event",b,c,d,e,h)})},this._addTrans=function(a,b,c,d,e,f,g,h,i){U(function(){V("_addTrans",a,b,c,d,e,f,g,h)}),W(function(){if(L._ecommerceEnabled(!0,"addTrans")){var f=function(a){return N("trackEcommerce",a,!0)};Y(f,"ecommerce:addTransaction",{id:a,affiliation:b,revenue:c,tax:d,shipping:e,currency:i||"USD"})}})},this._addItem=function(a,b,c,d,e,f){U(function(){V("_addItem",a,b,c,d,e,f)}),W(function(){if(L._ecommerceEnabled(!0,"addItem")){var g=function(a){return N("trackEcommerce",a,!0)};Y(g,"ecommerce:addItem",{id:a,name:c,sku:b,category:d,price:e,quantity:f})}})},this._trackTrans=function(){U(function(){V("_trackTrans")}),W(function(){if(L._ecommerceEnabled(!0,"trackTrans")){var a=function(a){return N("trackEcommerce",a,!0)};Y(a,"ecommerce:send")}})},this._clearTrans=function(){W(function(){if(L._ecommerceEnabled(!0,"clearTrans")){var a=function(a){return N("trackEcommerce",a,!0)};Y(a,"ecommerce:clear")}})},this._addProduct=function(b,c,d,e,f,g,h,i,j,k){U(function(){V("_addProduct",b,c,d,e,f,g,h,i,j)}),W(function(){if(L._enhancedEcommerceEnabled(!0,"addProduct")){var l=function(a){return N("trackEcommerce",a,!0)},m={id:b,name:c,category:d,brand:e,variant:f,price:g,quantity:h,coupon:i,position:j};a.isObject(k)&&a.extend(m,k),Y(l,"ec:addProduct",m)}})},this._addImpression=function(a,b,c,d,e,f,g,h){U(function(){V("_addImpression",a,b,c,d,e,f,g,h)}),W(function(){if(L._enhancedEcommerceEnabled(!0,"addImpression")){var i=function(a){return N("trackEcommerce",a,!0)};Y(i,"ec:addImpression",{id:a,name:b,category:e,brand:d,variant:f,list:c,position:g,price:h})}})},this._addPromo=function(a,b,c,d){U(function(){V("_addPromo",a,b,c,d)}),W(function(){if(L._enhancedEcommerceEnabled(!0,"addPromo")){var e=function(a){return N("trackEcommerce",a,!0)};Y(e,"ec:addPromo",{id:a,name:b,creative:c,position:d})}})},this._setAction=function(a,b){U(function(){V("_setAction",a,b)}),W(function(){if(L._enhancedEcommerceEnabled(!0,"setAction")){var c=function(a){return N("trackEcommerce",a,!0)};Y(c,"ec:setAction",a,b)}})},this._trackTransaction=function(a,b,c,d,e,f,g,h,i){this._setAction("purchase",S(a,b,c,d,e,f,g,h,i))},this._trackRefund=function(a){this._setAction("refund",S(a))},this._trackCheckOut=function(a,b){this._setAction("checkout",S(null,null,null,null,null,null,null,a,b))},this._trackDetail=function(){this._setAction("detail"),this._pageView()},this._trackCart=function(a,b){["add","remove"].indexOf(a)!==-1&&(this._setAction(a,{list:b}),this._trackEvent("UX","click",a+("add"===a?" to cart":" from cart")))},this._promoClick=function(a){this._setAction("promo_click"),this._trackEvent("Internal Promotions","click",a)},this._productClick=function(a){this._setAction("click",S(null,null,null,null,null,null,a,null,null)),this._trackEvent("UX","click",a)},this._pageView=function(a){W(function(){X(O("send",a),"pageview")})},this._send=function(){var a=Array.prototype.slice.call(arguments);a.unshift("send"),W(function(){X.apply(L,a)})},this._set=function(a,b,c){W(function(){X(O("set",c),a,b)})},this._trackTimings=function(a,c,d,e){W(function(){Y(b,"send","timing",a,c,d,e)})},this._trackException=function(a,c){W(function(){Y(b,"send","exception",{exDescription:a,exFatal:!!c})})},o||(this._registerScriptTags(),this._registerTrackers()),D&&I.$on(y,function(){(!z||P.current&&P.current.templateUrl&&!P.current.doNotTrack)&&L._trackPage()}),{log:L.log,offlineQueue:L.offlineQueue,configuration:{accounts:c,universalAnalytics:i,crossDomainLinker:l,crossLinkDomains:d,currency:m,debugMode:n,delayScriptTag:o,disableAnalytics:q,displayFeatures:p,domainName:e,ecommerce:L._ecommerceEnabled(),enhancedEcommerce:L._enhancedEcommerceEnabled(),enhancedLinkAttribution:t,experimentId:f,hybridMobileSupport:w,ignoreFirstPageLoad:u,logAllCalls:v,pageEvent:y,readFromRoute:z,removeRegExp:g,testMode:A,traceDebuggingMode:B,trackPrefix:C,trackRoutes:D,trackUrlParams:E},getUrl:Q,setCookieConfig:function(a){return L._log("warn","DEPRECATION WARNING: setCookieConfig method is deprecated. Please use tracker fields instead."),L._setCookieConfig.apply(L,arguments)},getCookieConfig:function(){return L._log("warn","DEPRECATION WARNING: getCookieConfig method is deprecated. Please use tracker fields instead."),j},createAnalyticsScriptTag:function(a){return L._log("warn","DEPRECATION WARNING: createAnalyticsScriptTag method is deprecated. Please use registerScriptTags and registerTrackers methods instead."),a&&(j=a),L._createAnalyticsScriptTag()},createScriptTag:function(){return L._log("warn","DEPRECATION WARNING: createScriptTag method is deprecated. Please use registerScriptTags and registerTrackers methods instead."),L._createScriptTag()},registerScriptTags:function(){return L._registerScriptTags()},registerTrackers:function(){return L._registerTrackers()},offline:function(a){if(a===!0&&x===!1&&(x=!0),a===!1&&x===!0)for(x=!1;L.offlineQueue.length>0;){var b=L.offlineQueue.shift();b[0].apply(L,b[1])}return x},trackPage:function(a,b,c){L._trackPage.apply(L,arguments)},trackEvent:function(a,b,c,d,e,f){L._trackEvent.apply(L,arguments)},addTrans:function(a,b,c,d,e,f,g,h,i){L._addTrans.apply(L,arguments)},addItem:function(a,b,c,d,e,f){L._addItem.apply(L,arguments)},trackTrans:function(){L._trackTrans.apply(L,arguments)},clearTrans:function(){L._clearTrans.apply(L,arguments)},addProduct:function(a,b,c,d,e,f,g,h,i,j){L._addProduct.apply(L,arguments)},addPromo:function(a,b,c,d){L._addPromo.apply(L,arguments)},addImpression:function(a,b,c,d,e,f,g,h){L._addImpression.apply(L,arguments)},productClick:function(a){L._productClick.apply(L,arguments)},promoClick:function(a){L._promoClick.apply(L,arguments)},trackDetail:function(){L._trackDetail.apply(L,arguments)},trackCart:function(a,b){L._trackCart.apply(L,arguments)},trackCheckout:function(a,b){L._trackCheckOut.apply(L,arguments)},trackTimings:function(a,b,c,d){L._trackTimings.apply(L,arguments)},trackTransaction:function(a,b,c,d,e,f,g,h,i){L._trackTransaction.apply(L,arguments)},trackException:function(a,b){L._trackException.apply(L,arguments)},setAction:function(a,b){L._setAction.apply(L,arguments)},pageView:function(){L._pageView.apply(L,arguments)},send:function(a){L._send.apply(L,arguments)},set:function(a,b,c){L._set.apply(L,arguments)}}}]}).directive("gaTrackEvent",["Analytics","$parse",function(a,b){return{restrict:"A",link:function(c,d,e){var f=b(e.gaTrackEvent);d.bind("click",function(){e.gaTrackEventIf&&!c.$eval(e.gaTrackEventIf)||f.length>1&&a.trackEvent.apply(a,f(c))})}}}]),a.module("angular-google-analytics")});